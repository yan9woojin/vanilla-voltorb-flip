var ce=Object.defineProperty;var de=(l,e,t)=>e in l?ce(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var a=(l,e,t)=>(de(l,typeof e!="symbol"?e+"":e,t),t),he=(l,e,t)=>{if(!e.has(l))throw TypeError("Cannot "+t)};var r=(l,e,t)=>{if(e.has(l))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(l):e.set(l,t)};var i=(l,e,t)=>(he(l,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function t(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=t(o);fetch(o.href,n)}})();var d,g,h,G;class V{constructor(e,t){r(this,d);r(this,h);a(this,"id");a(this,"element");a(this,"coin");this.id=e,this.element=document.getElementById(e),this.coin=t,i(this,d,g).call(this)}addCoin(e){this.coin+=e,i(this,h,G).call(this),i(this,d,g).call(this)}resetCoin(){this.coin=0,i(this,h,G).call(this),i(this,d,g).call(this)}}d=new WeakSet,g=function(){this.element.textContent=String(this.coin).padStart(5,"0")},h=new WeakSet,G=function(){localStorage.setItem(this.id,this.coin)};var u,q;class ue{constructor(e,t,s){r(this,u);a(this,"element");a(this,"minLevel");a(this,"maxLevel");a(this,"level");this.element=document.getElementById(e),this.minLevel=t,this.maxLevel=s,this.level=t}increase(){this.level=Math.min(this.level+1,this.maxLevel),i(this,u,q).call(this)}decrease(){this.level=Math.max(this.level-1,this.minLevel),i(this,u,q).call(this)}}u=new WeakSet,q=function(){this.element.textContent=this.level+1};const p="voltorb",me=5,fe=5,pe=1,ge=1,ye=3,we=0,ve=9,y=600;class be{constructor(e,t){a(this,"element",null);a(this,"value",null);a(this,"isFlipped",!1);a(this,"row");a(this,"col");this.row=e,this.col=t}toggleMemo(e){this.element.querySelector(`[data-memo="${e}"]`).classList.toggle("hide")}clearMemo(){this.element.querySelectorAll("[data-memo]").forEach(t=>t.classList.add("hide"))}flip(){this.element.classList.add("card__flipped"),this.element.setAttribute("data-card",this.value),this.isFlipped=!0}focus(){this.element.focus()}reset(){this.clearMemo(),this.element.classList.remove("card__flipped"),setTimeout(()=>{this.element.removeAttribute("data-card",this.value),this.value=null,this.isFlipped=!1},y)}}const Ce=""+new URL("bgm-f748036d.mp3",import.meta.url).href,Ee=""+new URL("coin-1c60e351.mp3",import.meta.url).href,Le=""+new URL("failure-76495d0c.mp3",import.meta.url).href,_e=""+new URL("success-eb08bb0f.mp3",import.meta.url).href,K=l=>Math.floor(Math.random()*l),U=l=>new URL(Object.assign({"/assets/audios/bgm.mp3":Ce,"/assets/audios/coin.mp3":Ee,"/assets/audios/failure.mp3":Le,"/assets/audios/success.mp3":_e})[`/assets/audios/${l}`],self.location).href;var w,j,v,X,b,$,C,H,E,W,L,Y,_,z,A,J,I,Q,m,D,S,Z,B,ee,M,te,O,se,T,oe,P,ie;class Ae{constructor(e,t){r(this,w);r(this,v);r(this,b);r(this,C);r(this,E);r(this,L);r(this,_);r(this,A);r(this,I);r(this,m);r(this,S);r(this,B);r(this,M);r(this,O);r(this,T);r(this,P);a(this,"bgm",document.getElementById("bgm"));a(this,"totalCoin",new V("totalCoin",Number(localStorage.getItem("totalCoin"))));a(this,"currentCoin",new V("currentCoin",0));a(this,"currentLevel",new ue("currentLevel",we,ve));a(this,"pause",!1);a(this,"cards",[]);a(this,"rows");a(this,"cols");this.rows=e,this.cols=t,i(this,w,j).call(this),i(this,v,X).call(this)}start(){i(this,M,te).call(this),i(this,b,$).call(this),i(this,C,H).call(this),i(this,L,Y).call(this),this.findCard(0,0).focus()}findCard(e,t){return this.cards.find(s=>s.row===e&&s.col===t)}moveFocus(e,t,s){if(!this.pause){switch(e){case"ArrowUp":t--;break;case"ArrowDown":t++;break;case"ArrowLeft":s--;break;case"ArrowRight":s++;break}t>=0&&t<this.rows&&s>=0&&s<this.cols&&this.findCard(t,s).focus()}}flipCard(e){e.isFlipped||this.pause||(e.flip(),i(this,_,z).call(this,e))}}w=new WeakSet,j=function(){for(let e=0;e<this.rows;e++)for(let t=0;t<this.cols;t++)this.cards.push(new be(e,t))},v=new WeakSet,X=function(){const e=document.getElementById("card-template"),t=document.querySelectorAll("[data-info]");this.cards.forEach(s=>{const n=e.content.cloneNode(!0).querySelector(".card"),{row:c,col:f}=s;n.setAttribute("data-row",c),n.setAttribute("data-col",f),s.element=n,t[c].insertAdjacentElement("beforebegin",n)})},b=new WeakSet,$=function(){let e=pe+this.currentLevel.level;for(;e>0;){const t=K(this.cards.length),s=this.cards[t];s.value===null&&(s.value=p,e--)}},C=new WeakSet,H=function(){this.cards.forEach(e=>{if(e.value===null){const t=K(ye)+ge;e.value=t}})},E=new WeakSet,W=function(){const e={row:new Array(this.rows).fill(0),col:new Array(this.cols).fill(0)},t={row:new Array(this.rows).fill(0),col:new Array(this.cols).fill(0)};this.cards.forEach(n=>{const{row:c,col:f,value:x}=n;x===p?(t.row[c]++,t.col[f]++):(e.row[c]+=x,e.col[f]+=x)});const s=[...e.row,...e.col],o=[...t.row,...t.col];return[s,o]},L=new WeakSet,Y=function(){const e=document.querySelectorAll("[data-coin-info]"),t=document.querySelectorAll("[data-voltorb-info]"),[s,o]=i(this,E,W).call(this);e.forEach((n,c)=>{n.textContent=String(s[c]).padStart(2,"0")}),t.forEach((n,c)=>{n.textContent=o[c]})},_=new WeakSet,z=function(e){if(e.value===p){i(this,A,J).call(this);return}if(this.cards.every(o=>o.isFlipped||o.value===p)){i(this,I,Q).call(this,e);return}i(this,O,se).call(this),this.currentCoin.addCoin(e.value)},A=new WeakSet,J=function(){i(this,P,ie).call(this),this.currentLevel.decrease(),this.currentCoin.resetCoin(),i(this,m,D).call(this)},I=new WeakSet,Q=function(e){i(this,T,oe).call(this),this.currentCoin.addCoin(e.value),this.totalCoin.addCoin(this.currentCoin.coin),this.currentLevel.increase(),this.currentCoin.resetCoin(),i(this,m,D).call(this)},m=new WeakSet,D=async function(){this.pause=!0,await i(this,S,Z).call(this),await i(this,B,ee).call(this),this.start(),this.pause=!1},S=new WeakSet,Z=function(){return new Promise((e,t)=>{setTimeout(()=>{this.cards.forEach(s=>s.flip()),e()},y)})},B=new WeakSet,ee=function(){return new Promise((e,t)=>{for(let o=0;o<this.cols;o++)setTimeout(()=>{this.cards.forEach(n=>{n.col===o&&n.reset()}),o===this.cols-1&&setTimeout(e,y)},1400+y*.6*o)})},M=new WeakSet,te=function(){this.bgm.play()},O=new WeakSet,se=function(){const e=new Audio(U("coin.mp3"));e.volume=.2,e.play()},T=new WeakSet,oe=function(){this.bgm.pause();const e=new Audio(U("success.mp3"));e.volume=.5,e.play(),e.addEventListener("ended",()=>{this.bgm.play()})},P=new WeakSet,ie=function(){this.bgm.pause();const e=new Audio(U("failure.mp3"));e.play(),e.addEventListener("ended",()=>{this.bgm.play()})};var R,ne,F,re,N,le,k,ae;class Ie{constructor(){r(this,R);r(this,F);r(this,N);r(this,k);a(this,"game",new Ae(me,fe))}init(){const e=document.getElementById("howToPlayBtn"),t=document.getElementById("playBtn"),s=document.getElementById("board");e.addEventListener("click",i(this,R,ne).bind(this)),t.addEventListener("click",i(this,F,re).bind(this)),s.addEventListener("keydown",i(this,N,le).bind(this))}}R=new WeakSet,ne=function(){document.getElementById("howToPlayModal").showModal()},F=new WeakSet,re=function(){i(this,k,ae).call(this),this.game.start()},N=new WeakSet,le=function(e){e.preventDefault();const t=e.key;if((e.ctrlKey||e.metaKey)&&t==="r"||t==="F5"){location.reload();return}const o=Number(e.target.dataset.row),n=Number(e.target.dataset.col),c=this.game.findCard(o,n);switch(t){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":this.game.moveFocus(t,o,n);break;case" ":this.game.flipCard(c);break;case"1":case"2":case"3":case"4":c.toggleMemo(t);break;case"Escape":c.clearMemo();break}},k=new WeakSet,ae=function(){const e=document.getElementById("menu"),t=document.getElementById("status"),s=document.getElementById("board");e.classList.toggle("hide"),t.classList.toggle("hide"),s.classList.toggle("hide")};const Se=new Ie;Se.init();
